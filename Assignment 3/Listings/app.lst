


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             AsmTemplate, CODE, READONLY
    2 00000000                 IMPORT           main
    3 00000000         
    4 00000000         ; sample program makes the 4 LEDs P1.16, P1.17, P1.18, P
                       1.19 go on and off in sequence
    5 00000000         ; (c) Mike Brady, 2011 -- 2019.
    6 00000000         
    7 00000000                 EXPORT           start
    8 00000000         start
    9 00000000         
   10 00000000 E0028010 
                       IO1PIN  EQU              0xE0028010
   11 00000000 E0028018 
                       IO1DIR  EQU              0xE0028018
   12 00000000 E0028014 
                       IO1SET  EQU              0xE0028014
   13 00000000 E002801C 
                       IO1CLR  EQU              0xE002801C
   14 00000000         
   15 00000000 E59F1100        ldr              r1,=IO1DIR
   16 00000004 E3A0280F        ldr              r2,=0x000f0000 ;select P1.19--P
                                                            1.16
   17 00000008 E5812000        str              r2,[r1]     ;make them outputs
   18 0000000C E59F10F8        ldr              r1,=IO1SET
   19 00000010 E5812000        str              r2,[r1]     ;set them to turn t
                                                            he LEDs off
   20 00000014 E59FB0F4        ldr              r11, =SUM   ;sum in mem
   21 00000018 E58BB000        str              r11, [r11]
   22 0000001C         
   23 0000001C         ;R12 - number we are currently working on
   24 0000001C E3A0C000        mov              r12, #0
   25 00000020         mainloop
   26 00000020         ;bl press
   27 00000020 E3A00502        ldr              r0, =0x00800000
   28 00000024 E3500000        cmp              r0, #0
   29 00000028 0A000002        beq              endSwitch
   30 0000002C E3500501        cmp              r0, #0x00400000
   31 00000030 AA000001        bge              numberChange
   32 00000034 EA000002        b                operatorChange
   33 00000038         endSwitch
   34 00000038 EAFFFFF8        b                mainloop
   35 0000003C         
   36 0000003C         numberChange
   37 0000003C         ;mov r1, r12
   38 0000003C EB000003        bl               numberChangeSub
   39 00000040 EAFFFFFC        b                endSwitch
   40 00000044         
   41 00000044         operatorChange
   42 00000044         ;mov r1, r12
   43 00000044 EB00000A        bl               operatorChangeSub
   44 00000048 EAFFFFFA        b                endSwitch
   45 0000004C         
   46 0000004C EAFFFFFE 
                       stop    B                stop
   47 00000050         
   48 00000050         ;R0 - button pressed
   49 00000050         ;R12 - current number
   50 00000050         numberChangeSub
   51 00000050 E92D4000        stmfd            sp!, {lr}



ARM Macro Assembler    Page 2 


   52 00000054 E3500502        cmp              r0, #0x00800000
   53 00000058 0A000001        beq              adding
   54 0000005C         ;subtracting
   55 0000005C E24CC001        sub              r12, r12, #1
   56 00000060 EA000000        b                endNumberChange
   57 00000064         adding
   58 00000064 E28CC001        add              r12, r12, #1
   59 00000068         
   60 00000068         endNumberChange
   61 00000068         
   62 00000068 E1A0100C        mov              r1, r12
   63 0000006C EB000018        bl               updateDisplay
   64 00000070 E8BD8000        ldmfd            sp!, { pc}
   65 00000074         
   66 00000074         operatorChangeSub
   67 00000074 E92D4000        stmfd            sp!, {lr}
   68 00000078 E58BC000        str              r12, [r11]  ; store num
   69 0000007C E28BB004        add              r11, r11, #4 ; inc address
   70 00000080 E3500602        cmp              r0, #0x00200000 ; +
   71 00000084 0A000002        beq              addition
   72 00000088         ;subtraction
   73 00000088 E3A0302D        ldr              r3, ='-'
   74 0000008C E58B3000        str              r3, [r11]
   75 00000090 EA000001        b                endOpChange
   76 00000094         
   77 00000094         addition
   78 00000094 E3A0302B        ldr              r3, ='+'
   79 00000098 E58B3000        str              r3, [r11]
   80 0000009C         endOpChange
   81 0000009C E28BB004        add              r11, r11, #4 ; inc adr
   82 000000A0 E8BD8000        ldmfd            sp!, { pc}
   83 000000A4         
   84 000000A4         press
   85 000000A4 E92D4000        stmfd            sp!, {lr}
   86 000000A8 E59F0064        ldr              r0, =IO1PIN
   87 000000AC E5900000        ldr              r0, [r0]
   88 000000B0 E3A0160F        ldr              r1, =0x00f00000
   89 000000B4 E0000001        and              r0, r0, r1
   90 000000B8 E1E00000        mvn              r0, r0
   91 000000BC E0000001        and              r0, r0, r1
   92 000000C0 E8BD8000        ldmfd            sp!, {pc}
   93 000000C4         
   94 000000C4         clearDisplay
   95 000000C4 E92D40FF        stmfd            sp!, {r0-r7, lr}
   96 000000C8 E59F103C        ldr              r1,=IO1SET
   97 000000CC E5810000        str              r0,[r1]     ;set them to turn t
                                                            he LEDs off
   98 000000D0 E8BD80FF        ldmfd            sp!, {r0-r7, pc}
   99 000000D4         
  100 000000D4         updateDisplay
  101 000000D4 E92D40FF        stmfd            sp!, {r0-r7, lr}
  102 000000D8 E1A00801        mov              r0, r1, lsl #16
  103 000000DC E59F1028        ldr              r1,=IO1SET
  104 000000E0 E3A0280F        mov              r2, #0x000f0000
  105 000000E4 E5812000        str              r2,[r1]     ;set them to turn t
                                                            he LEDs off
  106 000000E8         
  107 000000E8 E59F5028        ldr              r5,=40000000
  108 000000EC         dloop



ARM Macro Assembler    Page 3 


  109 000000EC E3550000        cmp              r5, #0
  110 000000F0 DA000001        ble              enddloop    ; while(delay > 0){
                                                            
  111 000000F4 E2555001        subs             r5,r5,#1    ;  delay--
  112 000000F8 EAFFFFFB        b                dloop
  113 000000FC         
  114 000000FC         enddloop
  115 000000FC E59F1018        ldr              r1,=IO1CLR
  116 00000100 E5810000        str              r0,[r1]     ;turn on the LED's
  117 00000104 E8BD80FF        ldmfd            sp!, {r0-r7, pc}
  118 00000108         
  119 00000108         
  120 00000108         
  121 00000108 E0028018 
              E0028014 
              00000000 
              E0028010 
              02625A00 
              E002801C         AREA             DATA, READWRITE
  122 00000000         
  123 00000000 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00    SUM     SPACE            50
  124 00000032         
  125 00000032                 END
Command Line: --debug --xref --diag_suppress=9931 --apcs=interwork --depend=.\a
pp.d -o.\app.o -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSIS\Include -IC:\Ke
il_v5\ARM\Inc\Philips --predefine="__MICROLIB SETA 1" --predefine="__UVISION_VE
RSION SETA 516" --list=.\listings\app.lst App.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

AsmTemplate 00000000

Symbol: AsmTemplate
   Definitions
      At line 1 in file App.s
   Uses
      None
Comment: AsmTemplate unused
adding 00000064

Symbol: adding
   Definitions
      At line 57 in file App.s
   Uses
      At line 53 in file App.s
Comment: adding used once
addition 00000094

Symbol: addition
   Definitions
      At line 77 in file App.s
   Uses
      At line 71 in file App.s
Comment: addition used once
clearDisplay 000000C4

Symbol: clearDisplay
   Definitions
      At line 94 in file App.s
   Uses
      None
Comment: clearDisplay unused
dloop 000000EC

Symbol: dloop
   Definitions
      At line 108 in file App.s
   Uses
      At line 112 in file App.s
Comment: dloop used once
endNumberChange 00000068

Symbol: endNumberChange
   Definitions
      At line 60 in file App.s
   Uses
      At line 56 in file App.s
Comment: endNumberChange used once
endOpChange 0000009C

Symbol: endOpChange
   Definitions
      At line 80 in file App.s
   Uses
      At line 75 in file App.s
Comment: endOpChange used once
endSwitch 00000038

Symbol: endSwitch



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 33 in file App.s
   Uses
      At line 29 in file App.s
      At line 39 in file App.s
      At line 44 in file App.s

enddloop 000000FC

Symbol: enddloop
   Definitions
      At line 114 in file App.s
   Uses
      At line 110 in file App.s
Comment: enddloop used once
mainloop 00000020

Symbol: mainloop
   Definitions
      At line 25 in file App.s
   Uses
      At line 34 in file App.s
Comment: mainloop used once
numberChange 0000003C

Symbol: numberChange
   Definitions
      At line 36 in file App.s
   Uses
      At line 31 in file App.s
Comment: numberChange used once
numberChangeSub 00000050

Symbol: numberChangeSub
   Definitions
      At line 50 in file App.s
   Uses
      At line 38 in file App.s
Comment: numberChangeSub used once
operatorChange 00000044

Symbol: operatorChange
   Definitions
      At line 41 in file App.s
   Uses
      At line 32 in file App.s
Comment: operatorChange used once
operatorChangeSub 00000074

Symbol: operatorChangeSub
   Definitions
      At line 66 in file App.s
   Uses
      At line 43 in file App.s
Comment: operatorChangeSub used once
press 000000A4

Symbol: press
   Definitions



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      At line 84 in file App.s
   Uses
      None
Comment: press unused
start 00000000

Symbol: start
   Definitions
      At line 8 in file App.s
   Uses
      At line 7 in file App.s
Comment: start used once
stop 0000004C

Symbol: stop
   Definitions
      At line 46 in file App.s
   Uses
      At line 46 in file App.s
Comment: stop used once
updateDisplay 000000D4

Symbol: updateDisplay
   Definitions
      At line 100 in file App.s
   Uses
      At line 63 in file App.s
Comment: updateDisplay used once
18 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

DATA 00000000

Symbol: DATA
   Definitions
      At line 121 in file App.s
   Uses
      None
Comment: DATA unused
SUM 00000000

Symbol: SUM
   Definitions
      At line 123 in file App.s
   Uses
      At line 20 in file App.s
Comment: SUM used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

IO1CLR E002801C

Symbol: IO1CLR
   Definitions
      At line 13 in file App.s
   Uses
      At line 115 in file App.s
Comment: IO1CLR used once
IO1DIR E0028018

Symbol: IO1DIR
   Definitions
      At line 11 in file App.s
   Uses
      At line 15 in file App.s
Comment: IO1DIR used once
IO1PIN E0028010

Symbol: IO1PIN
   Definitions
      At line 10 in file App.s
   Uses
      At line 86 in file App.s
Comment: IO1PIN used once
IO1SET E0028014

Symbol: IO1SET
   Definitions
      At line 12 in file App.s
   Uses
      At line 18 in file App.s
      At line 96 in file App.s
      At line 103 in file App.s

4 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

main 00000000

Symbol: main
   Definitions
      At line 2 in file App.s
   Uses
      None
Comment: main unused
1 symbol
359 symbols in table
